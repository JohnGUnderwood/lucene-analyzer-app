<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Analyzer - Lucene Token Analysis</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
</head>
<body>
    <!-- Side Panel -->
    <div id="sidePanel" class="side-panel">
        <div class="side-panel-content">
            <button class="close-btn" onclick="closeSidePanel()">&times;</button>
            <h2>How Lucene Works</h2>
            <p>
                Text data that is indexed or searched by Lucene goes through an Analyzer. Analyzers break down the source text
                into tokens, which Lucene's inverted index (using skip lists) will use to resolve the source documents that contain those tokens.
                Analyzers can remove whitespace, force lowercase, remove stopwords, remove accents (diacritic folding), and even stem words back to 
                their root forms (porter or snowball stemming algorithms). The analyzer you choose can greatly impact the search 
                experience for the user by allowing more search strings to match more indexed data, even before techniques like synonyms are
                applied to the search.
            </p>
            <p><strong>Which analyzer should I use?</strong></p>
            <ul>
                <li><strong>Lucene Standard</strong> - Forces lowercase, and removes whitespace in all languages. Can optionally remove accents. Does not perform stemming or stopword removal. You should always start here!</li>
                <li><strong>Lucene Whitespace</strong> - Removes whitespace in all languages. But retains case sensitivity. Useful for ID fields where upper/lower matters.</li>
                <li><strong>Lucene Simple</strong> - Removes whitespace in all languages. Forces lowercase. Useful for ID fields where upper/lower does not matter.</li>
                <li><strong>Lucene Keyword</strong> - Treats the entire string as a token. Ideal for Wildcard or Regex use cases.</li>
                <li><strong>Lucene Language Specific Analyzers</strong> - Removes whitespace, forces lowercase, removes accents and stems words to root forms. Best possible search experience IF you know the language up front.</li>
            </ul>
        </div>
    </div>

    <!-- Main Container -->
    <div class="container">
        <header>
            <h1>Search Analyzer</h1>
            <button class="info-btn" onclick="openSidePanel()">ℹ️ Info</button>
        </header>

        <!-- Input Section -->
        <div class="card input-card">
            <div class="card-header">
                <h2>Input</h2>
            </div>
            <div class="card-body">
                <div class="input-grid">
                    <!-- Index Text Section -->
                    <div class="input-section">
                        <div class="input-group">
                            <label for="indexText">Text to Analyze</label>
                            <textarea id="indexText" rows="3" class="form-control" placeholder="Enter text to be indexed...">The quick brown fox jumps over the lazy dog</textarea>
                        </div>

                        <div class="input-group">
                            <label for="indexAnalyzer">Index Analyzer</label>
                            <select id="indexAnalyzer" class="form-select">
                                <option value="">Loading...</option>
                            </select>
                        </div>

                        <div class="input-group">
                            <label class="checkbox-label">
                                <input type="checkbox" id="useAutocomplete">
                                Use&nbsp;<a href="https://www.mongodb.com/docs/atlas/atlas-search/field-types/autocomplete-type/" target="_blank">autocomplete</a>&nbsp;type with this analyzer
                            </label>
                        </div>

                        <div id="autocompleteOptions" class="autocomplete-options" style="display: none;">
                            <div class="input-group">
                                <label for="autocompleteType">Autocomplete Type</label>
                                <select id="autocompleteType" class="form-select">
                                    <option value="edgeGram">edgeGram</option>
                                    <option value="nGram">nGram</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="minGrams">Min Grams</label>
                                <input type="number" id="minGrams" class="form-control" value="3" min="1" max="50">
                            </div>
                            <div class="input-group">
                                <label for="maxGrams">Max Grams</label>
                                <input type="number" id="maxGrams" class="form-control" value="15" min="1" max="50">
                            </div>
                        </div>
                    </div>

                    <!-- Query Text Section -->
                    <div class="input-section">
                        <div class="input-group">
                            <label for="queryText">Query to Analyze</label>
                            <textarea id="queryText" rows="3" class="form-control" placeholder="Enter search query...">jumping fox</textarea>
                        </div>

                        <div class="input-group">
                            <label for="queryAnalyzer">Query Analyzer</label>
                            <select id="queryAnalyzer" class="form-select">
                                <option value="">Loading...</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="button-group">
                    <button id="analyzeBtn" class="btn btn-primary">Analyze</button>
                </div>
            </div>
        </div>

        <!-- Output Section -->
        <div class="card output-card" id="outputCard" style="display: none;">
            <div class="card-header">
                <h2>Output</h2>
            </div>
            <div class="card-body">
                <div class="tokens-section">
                    <h3>Index</h3>
                    <div id="indexAlert" class="alert" style="display: none;"></div>
                    <div id="indexTokens" class="tokens-container"></div>
                </div>

                <div class="tokens-section">
                    <h3>Query</h3>
                    <div id="queryAlert" class="alert" style="display: none;"></div>
                    <div id="queryTokens" class="tokens-container"></div>
                </div>

                <div class="info-section">
                    <h5>So, what does this all mean?</h5>
                    <p>When an analyzer breaks apart a string, it is determining which pieces (tokens) are relevant for searching. Depending on the analyzer chosen, this means removing special characters (? , !, .), language stemming (removing -s, -ed, -ing suffixes), and common terms (the, a, an) so that the remaining tokens can carry more weight and relevance on what the user is actually looking for.</p>
                    <p><strong>Green tokens</strong> indicate matches between the index and query - these are the terms that would allow the query to find the indexed document.</p>
                </div>

                <div class="button-group">
                    <button id="resetBtn" class="btn btn-secondary">Try Another</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="js/app.js"></script>
</body>
</html>
